<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-AU" lang="en-AU">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>email input tests Â· forces Constraint Validation API tests</title>

	<style>
		body {
			padding: 2em;
			font-family: sans-serif;
			background: #faf7f3;
			color: #111;
		}
	</style>
	<link rel="stylesheet" href="../../lib/qunit-git.css">
	<script src="../../lib/qunit-git.js"></script>
       
</head>

<body>

<form id="test" action="javascript:">

	<ol class="questions">

		<li>
			<label for="foo">
				<span class="label">Foo</span>
				<abbr title="(required)">*</abbr>
			</label>
			<input type="text" name="foo" id="foo" value="" />
		</li>

		<li>
			<label for="email">
				<span class="label">Email</span>
			</label>
			<input type="email" name="email" id="email" value="" />
		</li>

		<li class="footer">
			<ol class="submit">
				<li>
					<strong>
						<input type="submit" value="Submit" />
					</strong>
				</li>
			</ol>
		</li>

	</ol>

</form>


<div id="qunit">
	<h1 id="qunit-header">QUnit</h1>
	<h2 id="qunit-banner"></h2>
	<div id="qunit-testrunner-toolbar"></div>
	<h2 id="qunit-userAgent"></h2>
	<ol id="qunit-tests"></ol>
	<div id="qunit-fixture">test markup, will be hidden</div>
</div>


<script src="../../lib/jquery-1.4.4-min.js"></script>
<script src="../../src/forces.html5.constraintValidationAPI.js"></script>

<script><!-- //

	module( "environment" );

	test( "email fields are in test form", function() {

		equal( $( "form#test" ).length, 1, "form#test is present" );
		equal( $( "form#test input#foo" ).length, 1, "form#test contains input#foo" );
		equal( $( "form#test input#email" ).length, 1, "form#test contains input#email" );

	});

	test( "email fields are type email", function() {

		equal( $( "#foo" )[0].type, "text", "input#foo is type text" );
		equal( $( "#email" )[0].getAttribute( "type" ), "email", "input#email is type email" );

	});

	test( "form submission is suppressed", function() {

		var form = $( "#test" );

		form.submit();
		ok( true, "form was submitted and we are still running tests" );

		form.find( "[type=submit]" ).click();
		ok( true, "submit button clicked and we are still running tests" );

	});

	module( "input validityState typeMismatch" );

	test( "validity.typeMismatch is false when blank", function() {
		
		$( "#email,#foo" ).val( "" );
		$( "#test" ).submit();
		equal( $( "#email" )[0].validity.typeMismatch, false, "#email[value=\"\"] validity.typeMismatch should be false" );
		equal( $( "#email" )[0].validity.valid, true, "#email[value=\"\"] validity.valid should be true" );
		equal( $( "#foo" )[0].validity.typeMismatch, false, "#foo[value=\"\"] validity.typeMismatch should be false" );

	});

	test( "validity.typeMismatch is true when value is not an email address", function() {
		
		$( "#email,#foo" ).val( "foo" );
		$( "#test" ).submit();
		equal( $( "#email" )[0].validity.typeMismatch, true, "#email[value=\"foo\"] validity.typeMismatch should be true" );
		equal( $( "#email" )[0].validity.valid, false, "#email[value=\"\"] validity.valid should be false" );
		equal( $( "#foo" )[0].validity.typeMismatch, false, "#foo[value=\"foo\"] validity.typeMismatch should be false" );

	});


	test( "validity.typeMismatch is false when an email address is supplied", function() {
		
		$( "#email,#foo" ).val( "foo@example.com" );
		$( "#test" ).submit();
		equal( $( "#email" )[0].validity.typeMismatch, false, "#email[value=\"foo@example.com\"] validity.typeMismatch should be false" );
		equal( $( "#email" )[0].validity.valid, true, "#email[value=\"\"] validity.valid should be true" );
		equal( $( "#foo" )[0].validity.typeMismatch, false, "#foo[value=\"foo@example.com\"] validity.typeMismatch should be false" );

	});


// --></script>

</body>
</html>
